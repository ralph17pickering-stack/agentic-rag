**Status: Completed**

# Viewable Documents in RAG

**Complexity:** ⚠️ Medium

## Context

Documents uploaded to the RAG were opaque — users could see metadata but not read the actual content. This adds a document viewer so users can click any ready document to read the extracted text in a dialog.

## Approach

Store extracted text during ingestion, serve via a new endpoint, display in a modal dialog.

## Tasks

- [x] Add `extracted_text_path` column to documents table (migration 007)
- [x] Save extracted text as `{user_id}/{doc_id}_extracted.txt` in Storage during ingestion
- [x] `GET /api/documents/{id}/content` endpoint returns plain text (with legacy fallback)
- [x] Update `DocumentResponse` Pydantic model with `extracted_text_path`
- [x] Clean up `_extracted.txt` on document delete
- [x] `DocumentViewer` dialog component (fetch + display with loading/error states)
- [x] Integrate into `DocumentsPanel` — clickable title + Eye icon for ready docs

## Migration Required

```sql
ALTER TABLE documents ADD COLUMN IF NOT EXISTS extracted_text_path text;
```
